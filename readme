channging to c and cuda
